jQuery(document).ready(function($){window.TvrSharedVars={};window.TvrSharedVars.totalSecs=parseInt($("#total-sec-count").text());window.TvrSharedVars.TvrSugCSS={};window.TvrSharedVars.highlightEnabled=false;window.TvrSharedVars.tmpHighlighting=false;window.TvrSharedVars.tmpHideHighlighting=false;window.TvrSharedVars.progCount=0;window.TvrSharedVars.intelli=false;window.TvrSharedVars.awaitingIFrame=true;window.TvrSharedVars.cssProps=TvrCSSProps;window.TvrSharedVars.compProps={};window.TvrSharedVars.intelliCompProps={};window.TvrSharedVars.mixedElKey=0;window.TvrSharedVars.g_url="";TvrEditors={};var TvrCom={sT:function(e){if(!e){e="function"}TvrUi.profiler[e]=[];TvrUi.profiler[e]["sT"]=(new Date).getTime()},eT:function(e,t){if(!e){e="function"}TvrUi.profiler[e]["tE"]=(new Date).getTime()-TvrUi.profiler[e]["sT"];if(t){TvrCom.elT(e)}},elT:function(e){var t="";if(e){var n=TvrUi.profiler[e]["tE"].toFixed(2);t+=e+" took "+(n/1e3).toFixed(2)+" seconds ("+n+" ms)"}else{for(var e in TvrUi.profiler){var n=TvrUi.profiler[e]["tE"].toFixed(2);t+=e+" took "+n/1e3+" seconds ("+n+" ms)"+"\n"}}if(window.console&&window.console.log){console.log(t)}},hasValue:function(e){if(!!e){return true}else{return false}},isDefined:function(e){if(e!==""&&e!=="undefined"&&e!==undefined&&e!==null){return true}else{return false}},isDomEl:function(e){if(TvrCom.hasValue(e)&&e.prop("tagName")){return true}else{return false}},ucwords:function(e){return(e+"").replace(/^([a-z])|\s+([a-z])/g,function(e){return e.toUpperCase()})},readable_name:function(e){return TvrCom.ucwords((e+"").replace(/[_-]/g," "))},pipes_to_array:function(e){var t=new Array;var n=e.attr("rel").split("|");var r;for(r=0;r<n.length;++r){var i=n[r].split(",");t[i[0]]=parseInt(i[1])}return t},print_r:function(e,t){var n=t||"";var r=Object.prototype.toString.call(e)==="[object Array]";var i=r?"Array\n"+n+"[\n":"Object\n"+n+"{\n";for(var s in e){if(e.hasOwnProperty(s)){var o=e[s];var u="";var a=Object.prototype.toString.call(o);switch(a){case"[object Array]":case"[object Object]":u=TvrCom.print_r(o,n+"	");break;case"[object String]":u="'"+o+"'";break;default:u=o}i+=n+"	"+s+" => "+u+",\n"}}i=i.substring(0,i.length-2)+"\n"+n;return r?i+"]":i+"}"},extract_str:function(e,t){if(e=="gradient"){var n=t.split("linear-");if(n[0].indexOf("gradient")>=0){var r=n[0]}else if(n[1]&&n[1].indexOf("gradient")>=0){var r=n[1]}else{var r=""}}if(e=="bg-image"){var n=t.split("linear-");if(n[0].indexOf("url")<0){r="none"}else{r=TvrCom.basename(n[0]).replace(/\)?"/,"")}}return r},basename:function(e){if(!TvrCom.hasValue(e)){return e}return e.split(/[\\/]/).pop().replace(")","")},root_rel:function(e){return e.replace(TvrUi.siteUrl,"")},bind_input_labels:function(e){e.each(function(){var e=$(this);this.value=e.attr("title");e.addClass("text-label");e.bind("focus",function(){if(this.value==e.attr("title")){this.value="";e.removeClass("text-label")}});e.bind("blur",function(){if(this.value==""){this.value=e.attr("title");e.addClass("text-label")}})})},new_name_checks:function(e,t){if(t=="folder"){var n=$("#tvr-menu");var r=".section-name"}else{var n=TvrUi.meta.sectionM;var r=".selector-name"}if(TvrCom.duplicates(e,n,r)){alert("A "+t+" with that name already exists. Please enter a unique name.");return false}if(e==""||t=="folder"&&e=="New Folder..."){alert("Please enter a value for the "+t+" name");return false}var i=[];i["newNameHuman"]=e;i["newName"]=TvrCom.convert_to_param(e);return i},duplicates:function(e,t,n,r){var i=false;t.find(n).find(".name-text").each(function(){if(r&&$(this).closest(".selector-tag").attr("id")==r){return true}if(TvrCom.convert_to_param($(this).text())==TvrCom.convert_to_param(e)){i=true}});return i},resolve_unique_name:function(e,t,n,r,i){if(TvrCom.duplicates(e,t,n,i)){var s=1;do{if(!e.match(r)){var o=e+" "+r+" "+s}else{if(s==1){s=2}var o=e.replace(/Copy \d+/,r+" "+s)}++s}while(TvrCom.duplicates(o,t,n,i));return o}else{return e}},convert_to_param:function(e){e=e.replace(/[^a-zA-Z0-9 ]+/g,"").replace("/ {2,}/"," ");e=e.replace(/ /g,"_").toLowerCase();return e},refresh_sortable:function(){$("#tvr-menu").sortable({cursor:"move",handle:".folder-icon.sortable-icon",update:function(e,t){var n=TvrUi.get_meta(t.item,"section");var r=n.sectionM.prev().attr("id");if(!TvrCom.hasValue(r)){n.section.detach().prependTo("#tvr-options")}else{n.section.detach().insertAfter("#"+r.replace("strk","opts"))}if(TvrCom.hasValue(TvrUi.selInFocusID)){TvrUi.update_visual_controls($("#"+TvrUi.selInFocusID))}}}).find("ul.selector-sub").sortable({connectWith:"ul.selector-sub",cursor:"move",handle:".selector-icon.sortable-icon",refresh:"",receive:function(e,t){TvrCom.selector_received(e,t)},stop:function(e,t){var n=TvrUi.get_meta(t.item,"selector");var r=n.selectorM.prev().attr("id");if(!TvrCom.hasValue(r)){n.selector.detach().prependTo(n.section.find("ul.opts-selectors-sub"))}else{n.selector.detach().insertAfter("#"+r.replace("strk","opts"))}if(TvrCom.hasValue(TvrUi.selInFocusID)){TvrUi.update_visual_controls($("#"+TvrUi.selInFocusID))}}})},selector_received:function(e,t){var n=TvrUi.get_meta(t.item,"selector");if(!TvrUi.load_selector(n,"load selector after moving")){var r=TvrUi.get_meta(t.item.closest(".section-tag"),"section");TvrUi.update_count(n.sectionM.find(".selector-count-state"),"subtract",1,"selector","");TvrUi.update_count(r.sectionM.find(".selector-count-state"),"add",1,"selector","");var i=TvrCom.resolve_unique_name(n.selectorH,r.sectionM,".selector-name","Moved",n.selectorMID);TvrUi.dom_replacements("selector",n.selector.add(n.selectorM),n.sectionSlug,r.sectionSlug,r.sectionH,n.selectorSlug,TvrCom.convert_to_param(i),i,n.selectorM.find(".selector-css-textarea").val());if(TvrUi.selInFocusID==n.selectorID){TvrUi.update_global_vars(TvrUi.get_meta(n.selectorM,"selector"))}}},custom_escape_quotes:function(e){var t=e.replace(/"/g,"cus-quot;").replace(/'/g,"cus-#039;");return t},custom_to_non_escaped:function(e){var t=e.replace(/cus-quot;/g,'"').replace(/cus-#039;/g,"'");return t},regular_escape_quotes:function(e){var t=e.replace(/"/g,"&quot;").replace(/'/g,"&#039;");return t},regular_escaped_to_non_escaped:function(e){var t=e.replace(/&quot;/g,'"').replace(/&#039;/g,"'");return t},jquery_escape_quotes:function(e){var t=e.replace(/"/g,'\\"').replace(/'/g,"\\'");return t},jquery_escaped_to_non_escaped:function(e){var t=e.replace(/\\"/g,'"').replace(/\\'/g,"'");return t},custom_to_regular_escape:function(e){var t=e.replace(/cus-/g,"&");return t},sane_decimal:function(e){if(TvrCom.hasValue(e)&&e.indexOf("px")!=-1&&e.indexOf(".")!=-1){var t=e.split("px");return parseFloat(t[0]).toFixed(0)+"px"}else{return e}},isNumber:function(e){return e==parseFloat(e)},isOdd:function(e){return TvrCom.isNumber(e)&&Math.abs(e)%2==1},check_fake:function(e,t){if(!t){var t=e.prev()}if(e.hasClass("fake-radio")){e.closest(".fake-radio-parent").find('input[type="radio"]').prop("checked",false).end().find(".fake-radio").removeClass("on")}t.prop("checked",true);e.addClass("on")},uncheck_fake:function(e,t){if(!t){var t=e.prev()}if(e.hasClass("fake-radio")){return false}if(!t){var t=e.prev()}t.prop("checked",false);e.removeClass("on")},toggle_radio_checkbox:function(e){if(e.hasClass("toggle-checked-folders")){TvrUi.toggle_multi_checkboxes(e)}else{var t=e.prev();if(t.is(":checked")){TvrCom.uncheck_fake(e,t)}else{TvrCom.check_fake(e,t)}}}};var TvrUi={meta:{},profiler:[],debugCount:0,wasOpen:false,leftMenu:true,placeholderFrame:true,dataLoading:false,intelliAfterLoad:false,toolbarHeight:0,frameHeight:0,frameWidth:0,fullWidth:$("body").width(),iframe_slider_set:false,mqMin:TvrCom.pipes_to_array($("#tvr-min-store")),mqMax:TvrCom.pipes_to_array($("#tvr-max-store")),allDevicesWidth:TvrCom.hasValue($("#all_devices_default_width").attr("rel"))?$("#all_devices_default_width").attr("rel").replace("px",""):$("body").width(),totalSels:parseInt($("#total-sel-count").text()),trial:$("#plugin-trial").attr("rel")=="1"?false:true,trialNotice:"Please validate your purchase to unlock the full program! \nWith the free trial you are limited to editing or creating 9 Selectors.",gFontTarget:Object(),selsToLoad:0,totalToLoad:0,typingTimer:0,doneTypingInterval:700,saveInProgress:false,reSave:false,siteUrl:$("#site-url").attr("rel"),itemAlreadyExpanded:false,expanded:function(e){if(e=="main_menu"){var t=$("#tvr-main-menu")}else if(e=="quick_section"){var t=$("#sec-in-focus")}else if(e=="quick_selector"){var t=$("#sel-in-focus")}else if(e=="mq"){var n=$("#"+TvrUi.selInFocusID);if(TvrCom.isDomEl(n)){var t=n.find("span.add-mq")}else{return false}}return t.hasClass("on")?true:false},init:function(){$("#code-editors-wrap").find(".css-code-wrap").resizable({start:function(e,t){},resize:function(e,t){var n=t.size.height-t.originalSize.height;$("#v-frontend-wrap").css("height",TvrUi.frameHeight-n)},stop:function(e,t){TvrUi.toolbar_adjusted()}});var e=$.ui.autocomplete.prototype._renderMenu;$.ui.autocomplete.prototype._renderMenu=function(e,t){var n=this;$.each(t,function(t,r){n._renderItemData(e,r)});$(e).find("li").each(function(e){var t=$(this);if(!TvrCom.isDomEl(t.find("a"))){t.addClass("empty ui-menu-item")}})};$("input.combobox").live("focus",function(){var e=$(this);var t=TvrCombo[e.attr("rel")];if(!t){t=[]}e.autocomplete({source:t,delay:0,minLength:0,appendTo:e.parent(".input-wrap"),open:function(t,n){e.next(".combo-arrow").addClass("on");if(e.hasClass("property-input")){var r=TvrUi.get_meta(e,"property");r.property.find(".comp-mixed-table").addClass("manual-menu-showing")}},select:function(t,n){e.val(n.item.value);e.parent(".input-wrap").addClass("manual-val").find(".comp-style").addClass("hidden").end().find(".combo-arrow").removeClass("on");if(e.hasClass("property-input")){if(e.hasClass("tvr-font-select")){var r=e.closest(".field-wrap").siblings(".tvr-font-custom");TvrUi.gFontTarget=r.find(".property-input");if(n.item.value=="Google Font..."){TvrUi.show_google_fonts(r)}else{TvrUi.hide_google_fonts(e,r)}}else{if(e.hasClass("img_display")){if(!TvrCom.hasValue(n.item.value)){TvrUi.clear_bg_image(e)}else if(n.item.value=="none"){TvrUi.update_bg_image(e,n.item.value)}}TvrUi.ajax_save_settings("save")}}},search:function(t,n){e.addClass("adjusted-corner-radius")},close:function(t,n){e.removeClass("adjusted-corner-radius").next(".combo-arrow").removeClass("on");if(e.hasClass("property-input")){var r=TvrUi.get_meta(e,"property");r.property.find(".comp-mixed-table").removeClass("manual-menu-showing")}}})});$("span.combo-arrow").live("mousedown",function(){if($(this).siblings(".ui-menu").is(":visible")){TvrUi.wasOpen=true}});$("span.combo-arrow").live("click",function(){var e=$(this);var t=e.prev();if(TvrUi.wasOpen){e.removeClass("on");TvrUi.wasOpen=false;return}else{e.addClass("on");t.focus().autocomplete("search","")}});TvrUi.reset_global_vars();$(window).keypress(function(e){if(!(e.which==115&&e.ctrlKey)&&!(e.which==19))return true;e.preventDefault();return false});$(document).keydown(function(e){if(e.which==83&&e.ctrlKey==true){TvrUi.ajax_save_settings("save");e.preventDefault();return false}else if(TvrCom.hasValue($(e.target))&&$(e.target).attr("class")&&$(e.target).attr("class").indexOf("strictly-dropdown")>-1){e.preventDefault();return false}});TvrCom.bind_input_labels($("#add-new-section").find("input").add("#wizard_folder"));TvrCom.refresh_sortable();$(".scrollable-area").mCustomScrollbar({theme:"dark-3",live:true,scrollInertia:0,mouseWheel:{enable:true,normalizeDelta:false,scrollAmount:40}});var t=$("#tvr-ui");t.dblclick(function(e){var t=$(e.target);if(t.hasClass("autofillable")){var n=t.val();var r=t.attr("data-autofill");var i=TvrUi.get_meta(t,"group");i.group.find('input[data-autofill="'+r+'"]').each(function(){var e=$(this);e.attr("value",n);if(e.hasClass("color")){}TvrUi.adjust_comp_span(e,"after")});TvrUi.ajax_save_settings("save")}});t.delegate("input.color","change",function(){TvrUi.ajax_save_settings("save");TvrUi.adjust_comp_span($(this),"after")});t.delegate("input.property-input","keyup",function(e){if($(e.target).attr("class").indexOf("img_display")<0){if(TvrUi.typingTimer){clearTimeout(TvrUi.typingTimer)}TvrUi.typingTimer=setTimeout(TvrUi.done_typing,TvrUi.doneTypingInterval)}TvrUi.adjust_comp_span($(this),"after")});t.delegate("select.tvr-font-select","change",function(){var e=$(this);var t=e.parent(".field-wrap").siblings(".tvr-font-custom");TvrUi.gFontTarget=e.parent("div.field-wrap").siblings(".tvr-font-custom").find(".property-input");if(e.val()=="Google Font..."){t.show("fast");$.colorbox({href:$("#fonts-api").attr("rel"),innerHeight:"80%",innerWidth:"95%",fixed:true,iframe:true,open:true});TvrUi.font_changed(TvrUi.gFontTarget)}else{TvrUi.gFontTarget.val("").prop("val","");t.hide();TvrUi.font_changed(e)}});t.delegate(".property-input, tr.mixed-val","mouseenter",function(){var e=$(this);if(e.hasClass("property-input")){TvrUi.adjust_comp_span(e,"hover")}if(e.hasClass("mixed-val")){window.TvrSharedVars.mixedElKey=e.attr("rel");if(!window.TvrSharedVars.highlightEnabled){window.TvrSharedVars.tmpHighlighting=true;TvrUi.toggle_highlighting()}if(TvrUi.iframe_functions_loaded()){window.frames["viframe"].TvrExportVars.switch_highlight("mixed-hover")}}});t.delegate(".property-input, tr.mixed-val","mouseleave",function(){var e=$(this);if(e.hasClass("property-input")){TvrUi.adjust_comp_span(e,"after")}if(e.hasClass("mixed-val")){TvrUi.return_normal_highlighting()}});$("#mq-list").sortable();$("#edit-media-queries-form").submit(function(){var e=false;$("#mq-list").find("input.m-label, input.m-code").each(function(){if($(this).val().length==0){$(this).focus();e=true;return false}});if(e){alert("Please complete all media query fields or delete empty ones.");return false}});TvrUi.load_visual_view($("#load-visual"));$visCon=$("#tvr");$visCon.click(function(e){var t=$(e.target);try{n=t.attr("class");if(!n){var n="tvr-undefined"}}catch(r){}TvrUi.close_all_expanded(t,n);if(n.indexOf("fake-checkbox")>=0||n.indexOf("fake-radio")>=0){TvrCom.toggle_radio_checkbox(t)}else if(t.attr("id")=="email-error"){TvrUi.email_error_report()}else if(n.indexOf("tvr-main-menu-wrap")>=0){TvrUi.show_main_menu(t)}else if(n.indexOf("sec-in-focus")>=0||n.indexOf("sel-in-focus")>=0){TvrUi.quick_edit(t)}else if(n.indexOf("edit-css-code")>=0){TvrUi.toggle_hand_css(t)}else if(t.attr("id")=="toggle-left-menu"){TvrUi.toggle_left_menu()}else if(n.indexOf("m-logo")>=0){window.open(t.attr("rel"),"_blank")}else if(n.indexOf("save-interface")>=0){TvrUi.ajax_save_settings("save")}else if(n.indexOf("show-dialog")>=0){TvrUi.show_dialog(t)}else if(n.indexOf("close-dialog")>=0||n.indexOf("tvr-dialog")>=0){TvrUi.close_dialog(t)}else if(n.indexOf("back-to-wordpress")>=0){window.location=t.attr("rel")}else if(n.indexOf("add-m-query")>=0){TvrUi.add_m_query(t)}else if(n.indexOf("del-m-query")>=0){TvrUi.del_m_query(t)}else if(n.indexOf("reveal-hidden-form-opts")>=0){TvrUi.reveal_form_opts(t)}else if(t.attr("id")=="ui-reset"){TvrUi.ui_reset(t)}else if(t.attr("id")=="clear-styles"){TvrUi.clear_styles(t)}else if(n.indexOf("export-dialog-button")>=0){TvrUi.export_settings()}else if(n.indexOf("ui-import")>=0){TvrUi.import_settings()}else if(n.indexOf("reveal-unlock")>=0){$("#tvr_validate_form").addClass("show");t.parent("p").hide()}else if(n.indexOf("explain-link")>=0){TvrUi.toggle_help_info(t)}else if(n.indexOf("restore-link")>=0){TvrUi.restore_rev(t)}else if(n.indexOf("folder-menu-arrow")>-1||n.indexOf("selector-count-state")>-1||n.indexOf("folder-count-wrap")>-1||n.indexOf("folder-state-count")>-1){TvrUi.toggle_folder(t)}else if(n.indexOf("new-section-input")>=0){$("#main-menu-scroll").mCustomScrollbar("scrollTo","top")}else if(n.indexOf("new-section-add")>=0){TvrUi.add_section(t)}else if(n.indexOf("toggle-rename-section")>=0){TvrUi.toggle_rename_section(t)}else if(n.indexOf("cancel-rename-section")>=0){TvrUi.toggle_rename_section(t)}else if(n.indexOf("rename-button")>=0){TvrUi.action_rename_section(t)}else if(n.indexOf("copy-section")>=0){TvrUi.copy_section(t)}else if(n.indexOf("delete-section")>=0){TvrUi.delete_section(t)}else if(n.indexOf("reveal-add-selector")>=0){TvrUi.toggle_add_selector(t)}else if(n.indexOf("cancel-add-selector")>=0){TvrUi.toggle_add_selector(t)}else if(n.indexOf("add-selector")>=0){TvrUi.add_selector(t)}else if(n.indexOf("toggle-modify-selector")>=0||n.indexOf("cancel-edit-selector")>=0){TvrUi.toggle_modify_selector(t)}else if(n.indexOf("edit-selector")>=0){TvrUi.action_modify_selector(t)}else if(n.indexOf("copy-selector")>=0){TvrUi.copy_selector(t)}else if(n.indexOf("delete-selector")>=0){TvrUi.delete_selector(t)}else if(n.indexOf("change-selector")>=0){TvrUi.tvr_iterate_selectors_v(t)}else if(n.indexOf("scroll-buttons")>=0){TvrUi.quick_nav(t)}else if(n.indexOf("cancel-wizard")>=0){TvrUi.hide_wizard()}else if(n.indexOf("adv-main-label")>=0){TvrUi.toggle_adv_wizard()}else if(n.indexOf("refine-button")>=0&&n.indexOf("disabled")<0){TvrUi.switch_html_element(t)}else if(n.indexOf("wizard-add")>=0){TvrUi.wizard_new_selector(t)}else if(t.attr("id")=="toggle-highlighting"){TvrUi.toggle_highlighting()}else if(n.indexOf("pg-icon")>=0){TvrUi.pg_icon_pressed(t)}else if(n.indexOf("css-tab")>=0&&n.indexOf("active")<0){TvrUi.css_tab_pressed(t)}else if(n.indexOf("adv-tab")>=0&&n.indexOf("active")<0){TvrUi.adv_tab_pressed(t)}else if(n.indexOf("mq-tab")>=0&&n.indexOf("css-tab")<0&&n.indexOf("adv-tab")<0&&n.indexOf("active")<0){TvrUi.mq_tab_pressed(t)}else if(n.indexOf("add-mq-icon")>=0){TvrUi.show_add_mq(t)}else if(n.indexOf("mq-add-remove")>=0){TvrUi.toggle_pg_fields(t)}else if(n.indexOf("mq-remove-all")>=0){TvrUi.remove_property_group(t,"delete-all")}else if(n.indexOf("tvr-image-upload")>=0){TvrUi.launch_img_uploader(t)}else if(n.indexOf("clear-bg-image")>=0){TvrUi.clear_bg_image(t)}else if(n.indexOf("combobox")>=0){TvrUi.combobox_clicked(t)}else if(n.indexOf("g-font")>=0){var i=t.closest(".field-wrap");TvrUi.gFontTarget=i.find(".property-input");TvrUi.show_google_fonts(i)}else if(n.indexOf("v-mq-button")>=0&&n.indexOf("active")<0){TvrUi.update_mq_button(t)}else if(n.indexOf("css-info")>=0){TvrUi.load_css_ref(t)}else if(n.indexOf("input-icon-toggle")>=0){TvrUi.input_icon_toggle(t)}else if(n.indexOf("css-group-heading")>=0||n.indexOf("accordion-menu-arrow")>=0||n.indexOf("text-for-group")>=0){t=t.closest(".css-group-heading");TvrUi.update_accordion(t,$("#html-computed-css"))}})},show_main_menu:function(e){if(TvrUi.itemAlreadyExpanded){return false}e.addClass("on expanded")},hide_main_menu:function(){$("#tvr-main-menu").removeClass("on expanded")},quick_edit:function(e){if(TvrUi.itemAlreadyExpanded){return false}var t=TvrUi.get_meta($("#"+TvrUi.selInFocusID),"selector");$("#main-menu-popdown").addClass("bye-for-now");t.sectionM.addClass("hello-me");var n=t.sectionM.find(".menu-arrow");var r=t.selectorM.find(".edit-selector-form");if(!n.hasClass("on")){TvrUi.toggle_folder(n)}if(e.hasClass("sec-in-focus")){var i=t.sectionM;if(r.hasClass("show")){TvrUi.toggle_modify_selector(r)}t.sectionM.find(".folder-icon").removeClass("sortable-icon")}else{var i=t.selectorM;if(!r.hasClass("show")){TvrUi.toggle_modify_selector(r)}t.sectionM.addClass("goodbye-section");t.selectorM.addClass("hello-me");t.selectorM.find(".selector-icon").removeClass("sortable-icon")}i.addClass("quick-edit-mode scrollable-area-not-live expanded").mCustomScrollbar({theme:"dark-3",scrollInertia:0,mouseWheel:{enable:true,normalizeDelta:false,scrollAmount:40}}).append('<div class="hide-top-shadow"></div>');e.addClass("on")},close_quick_edit:function(){var e=$("#main-menu-popdown");var t=e.find(".quick-edit-mode");if(t.hasClass("section-tag")){var n="folder";var r=TvrUi.get_meta(t,"section");var i=r.sectionM}else{var n="selector";var r=TvrUi.get_meta(t,"selector");var s=r.selectorM.find(".edit-selector-form");if(s.hasClass("show")){s.removeClass("show")}var i=r.sectionM.add(r.selectorM)}t.find("."+n+"-icon").addClass("sortable-icon");t.removeClass("quick-edit-mode scrollable-area-not-live expanded").mCustomScrollbar("destroy");var o=r.sectionM.find(".menu-arrow");if(o.hasClass("on")){TvrUi.toggle_folder(o)}$("#current-selector").find(".on").removeClass("on");i.removeClass("hello-me goodbye-section");e.removeClass("bye-for-now")},close_all_expanded:function(e,t){if(e.hasClass("on")){TvrUi.itemAlreadyExpanded=true}else{TvrUi.itemAlreadyExpanded=false}if(TvrCom.isDomEl(e.parents(".expanded"))&&!e.hasClass("add-mq-icon")&&!e.hasClass("change-selector")){return false}if(TvrUi.expanded("main_menu")){TvrUi.hide_main_menu()}else if(TvrUi.expanded("quick_section")||TvrUi.expanded("quick_selector")){TvrUi.close_quick_edit()}else if(TvrUi.expanded("mq")){TvrUi.hide_add_mq()}},reset_global_vars:function(){TvrUi.selInFocusID="";window.TvrSharedVars.curSelCSS="#no-element";window.TvrSharedVars.intelli_css="#no-element";window.TvrSharedVars.pgInFocus="";window.TvrSharedVars.compPgInFocus=""},update_global_vars:function(e){TvrUi.selInFocusID=e.selectorID;window.TvrSharedVars.curSelCSS=TvrCom.custom_escape_quotes(e.selectorM.find(".selector-css-textarea").val());$("#last-edited-selector").val(TvrUi.selInFocusID);var t=$("#current-selector");if($("#sec-in-focus").hasClass("on")){var n="on"}else{var n=""}if($("#sel-in-focus").hasClass("on")){var r="on"}else{var r=""}$("#current-selector").html('<span class="breadcrumb-arrow first-breadcrumb">&raquo;</span>'+'<span id="sec-in-focus" class="sec-in-focus '+n+'" '+'title="Quick Edit - Current Folder">'+e.sectionH+'</span> <span class="breadcrumb-arrow">&raquo;</span> <span id="sel-in-focus" '+'class="sel-in-focus '+r+'" title="Quick Edit - Current Selector">'+e.selectorH+"</span>")},menu_object:function(e){return $("#"+e.replace("opts","strk"))},section_slug:function(e){var t=TvrUi.get_meta($("#"+e),"selector");return t.sectionSlug},allowed_action:function(e,t){var n=false;if(!TvrUi.trial){return true}if(t=="Edit Sel"&&TvrCom.isDomEl(e.closest(".trial-disabled"))){var n=true}if(t=="Add Sel"&&TvrUi.totalSels>=9){var n=true}if(n){alert(TvrUi.trialNotice);return false}else{return true}},load_css_ref:function(e){TvrUi.show_dialog(e)},font_changed:function(e){TvrUi.ajax_save_settings("save");TvrUi.adjust_comp_span(e,"after")},show_google_fonts:function(e){e.show("fast");$.colorbox({href:$("#fonts-api").attr("rel"),innerHeight:"80%",innerWidth:"95%",fixed:true,iframe:true,open:true});TvrUi.font_changed(TvrUi.gFontTarget)},hide_google_fonts:function(e,t){TvrUi.gFontTarget.val("").prop("val","");t.hide();TvrUi.font_changed(e)},insert_google_font:function(e){$.colorbox.close();TvrUi.gFontTarget.val(e).focus();TvrUi.font_changed(TvrUi.gFontTarget)},launch_img_uploader:function(e){wp.media.editor.send.attachment=function(t,n){TvrUi.update_bg_image(e,n.url)};wp.media.editor.open(e);return false},update_bg_image:function(e,t){var n=TvrUi.get_meta(e,"property");n.property.find(".image-url-store").val(t);n.property.find(".img_display").val(TvrCom.basename(t));TvrUi.ajax_save_settings("save");TvrUi.adjust_comp_span(n.property.find(".img_display"),"after")},clear_bg_image:function(e){TvrUi.update_bg_image(e,"")},toggle_hand_css:function(e){if(!e.hasClass("on")){TvrUi.show_hand_css(e)}else{TvrUi.hide_hand_css(e)}TvrUi.toolbar_adjusted()},show_hand_css:function(e){var t=$("#visual-view");if(t.hasClass("show-wizard")){TvrUi.hide_wizard()}t.addClass("show-code-editor");e.addClass("on");if(!TvrEditors.setUp){}},hide_hand_css:function(e){$("#visual-view").removeClass("show-code-editor");e.removeClass("on")},set_up_editors:function(){var e=$("#editors-list").attr("rel").split("|");for(var t in e){alert(e[t]);TvrEditors[e[t]]=ace.edit("custom-css-"+e[t]);TvrEditors[e[t]].setTheme("ace/theme/chrome");TvrEditors[e[t]].getSession().setMode("ace/mode/css");TvrEditors[e[t]].setShowPrintMargin(false);TvrEditors[e[t]].getSession().on("change",function(n){$("#custom-css-"+e[t]).addClass("changed")})}},input_icon_toggle:function(e){var t=e.attr("data-input-type");if(t=="important"){var n=TvrUi.get_meta(e,"property");var r=n.property.find(".property-input").attr("name");if(!e.hasClass("imp-mq")){var i=r.replace("tvr_mcth","tvr_mcth[non_section][important]").replace("[styles]","")}else{var i=r.replace("[non_section]","[non_section][important]").replace("[styles]","")}}else if(t=="pie"||t=="boxsizing"){var n=TvrUi.get_meta(e,"selector");var i=n.selectorM.find("input.register-selector").attr("name")+"["+t+"]"}if(e.attr("rel")=="off"){var s='<input class="'+t+'-tracker" type="hidden" name="'+i+'" value="1" />';e.attr("rel","on").addClass("active").before(s)}else if(e.attr("rel")=="on"){e.attr("rel","off").removeClass("active").prev("."+t+"-tracker").remove()}TvrUi.ajax_save_settings("save")},get_meta:function(e,t){TvrUi.meta={};var n=["stub","section","selector","group","property"];for(var r in n){if(n[r]==t){if(e.attr("class")&&e.attr("class").indexOf(t+"-tag")>=0){var i=e}else{var i=e.closest("."+t+"-tag")}var s=i.attr("id");var o=s.split("-")}}var u="";for(var a in o){if(a==0||a==5){continue}t=n[a];u+="-"+o[a];if(t=="property"){u+="-"+o[5];if(o[5]=="all"){u+="-devices"}}TvrUi.meta[t]=$("#opts"+u);TvrUi.meta[t+"M"]=$("#strk"+u);TvrUi.meta[t+"Slug"]=o[a];if(t=="section"){TvrUi.meta[t+"T"]=$(TvrUi.meta[t+"M"]).find("input.section-tracker");TvrUi.meta[t+"H"]=$(TvrUi.meta.sectionM).find(".section-display-name").val();TvrUi.meta[t+"ID"]="opts-"+TvrUi.meta.sectionSlug;TvrUi.meta[t+"MID"]="strk-"+TvrUi.meta.sectionSlug}else if(t=="selector"){var f=$(TvrUi.meta.selectorM).find(".selector-label").val().split("|");TvrUi.meta[t+"T"]=$(TvrUi.meta[t+"M"]).find("input.selector-tracker");TvrUi.meta[t+"H"]=f[0];TvrUi.meta[t+"ID"]="opts-"+TvrUi.meta.sectionSlug+"-"+TvrUi.meta.selectorSlug;TvrUi.meta[t+"MID"]="strk-"+TvrUi.meta.sectionSlug+"-"+TvrUi.meta.selectorSlug}else if(t=="group"){TvrUi.meta[t+"H"]=TvrCom.ucwords(TvrUi.meta[t+"Slug"]);TvrUi.meta[t+"ID"]="opts-"+TvrUi.meta.sectionSlug+"-"+TvrUi.meta.selectorSlug+"-"+TvrUi.meta.groupSlug;TvrUi.meta[t+"MID"]="strk-"+TvrUi.meta.sectionSlug+"-"+TvrUi.meta.selectorSlug+"-"+TvrUi.meta.groupSlug}}return TvrUi.meta},jscolor_bind:function($obj){var matchClass=new RegExp("(^|\\s)("+mcthmr_jscolor.bindClass+")\\s*(\\{[^}]*\\})?","i");var e=$obj.find("input.color");for(var i=0;i<e.length;i+=1){var m;if((!e[i].color||e[i].color=="ffffff")&&e[i].className&&(m=e[i].className.match(matchClass))){var prop={};if(m[3]){try{eval("prop="+m[3])}catch(eInvalidProp){}}e[i].color=new mcthmr_jscolor.color(e[i],prop)}}},update_count:function(e,t,n,r,i){if(!TvrCom.hasValue(i)){i=0}var s=parseInt(e.attr("rel"));if(t=="add"){var o=s+parseInt(n)}else if(t=="subtract"){var o=s-parseInt(n)}e.attr("rel",o);if(r!="section"){if(s==0){e.after(' <span class="count-wrap">(<span class="state-count"></span>)</span>');var u=true}if(o==0){e.next("span").remove();var a=true}else{e.next("span").find(".state-count").text(parseInt(o))}}if(r=="section"){var f=$("#total-sec-count");var l=parseInt(f.text());if(o>s){window.TvrSharedVars.totalSecs=parseInt(l+n);f.text(window.TvrSharedVars.totalSecs);TvrUi.totalSels=TvrUi.totalSels+parseInt(i);$("#total-sel-count").text(parseInt(TvrUi.totalSels))}else{window.TvrSharedVars.totalSecs=parseInt(l-n);f.text(window.TvrSharedVars.totalSecs);TvrUi.totalSels=TvrUi.totalSels-parseInt(i);$("#total-sel-count").text(parseInt(TvrUi.totalSels))}}else if(r=="selector"){var c=$("#total-sel-count");var h=parseInt(c.text());if(o>s){TvrUi.totalSels=parseInt(h+n);c.text(TvrUi.totalSels)}else{TvrUi.totalSels=parseInt(h-n);c.text(TvrUi.totalSels)}}else if(r=="style"){}TvrUi.toggle_enabled_buttons()},com_data_loading:function(e,t){e.find("."+t+"-row").append($("#loading-gif-template").clone().removeAttr("id"));TvrUi.update_prog_indicator("plus","Loading Style Options...")},com_data_finished_loading:function(e,t){e.find("img.ajax-loader").remove();TvrUi.update_prog_indicator("minus",t)},ajax_load_ui_data:function(e,t,n,r,i,s,o,u){TvrUi.dataLoading=true;TvrUi.log_action(t,"data-load");var a=$("#ui-nonce").text();var f="admin.php?page=tvr-microthemer.php";var l="action=tvr_microthemer_ui_load_styles&tvr_load_section="+r;l+="&tvr_load_type="+s;l+="&_wpnonce="+a;var c="all-groups";l+="&tvr_load_selector="+i;$.ajax({type:"GET",url:f,async:true,data:l,timeout:2e4,error:function(e,n){TvrUi.com_data_finished_loading(t,["Options failed to load","<p>"+TvrUi.handle_ajax_error(e,n)+"</p>"+"<p>The styling options failed to load into the interface. This sometimes happens if "+'WordPress silently logs you out or because your "nonce" expires as a result of inactivity. '+"Please refresh the page and try to log back in if necessary.</p>"])},success:function(r){var i=$(r).find("#tmp-wrap").html();e.append(i);TvrUi.jscolor_bind(e);n.val(2);if(o!=3){TvrUi.unlog_action(t,"data-load");TvrUi.com_data_finished_loading(t);if(u=="load selector before modifying"){TvrUi.toggle_modify_selector(t.find(".edit-icon"))}if(u=="load selector before iterating"){TvrUi.tvr_iterate_selectors_v(t)}if(u=="load selector before copying"){TvrUi.copy_selector(t)}if(u=="load selector after moving"){var s={item:t};TvrCom.selector_received({},s)}}else{--TvrUi.selsToLoad;if(TvrUi.selsToLoad==0){TvrUi.unlog_action(t,"all-sels-loading");if(u=="sec rename, load styles discretely"){TvrUi.toggle_rename_section(t.find(".edit-icon"))}if(u=="sec copy, load styles discretely"){TvrUi.copy_section(t.find(".copy-icon"))}TvrUi.com_data_finished_loading(t)}}},complete:function(){TvrUi.unlog_action(t,"data-load");TvrUi.dataLoading=false}})},ajax_load_revisions_table:function(){TvrUi.update_prog_indicator("plus","Loading Revisions Table...");var e=$("#revisions-url").attr("rel");$.ajax({type:"GET",url:e,async:true,timeout:2e4,error:function(e,t){TvrUi.update_prog_indicator("minus",["Revisions failed to load","<p>"+TvrUi.handle_ajax_error(e,t)+"</p>"])},success:function(e){var t=$(e).find("#tmp-wrap").html();$("#revision-area").html(t);TvrUi.update_prog_indicator("minus")},complete:function(){}})},ajax_load_css:function(){TvrUi.update_prog_indicator("plus","Retrieving CSS...");var e=$("#active-styles-url").attr("rel")+"?nocache="+(new Date).getTime();$.ajax({type:"GET",url:e,async:true,timeout:2e4,error:function(e,t){TvrUi.update_prog_indicator("minus",["CSS failed to load","<p>"+TvrUi.handle_ajax_error(e,t)+"</p>"])},success:function(e){$("#generated-css").html(e);TvrUi.update_prog_indicator("minus")},complete:function(){}})},ajax_load_external_js:function(e,t){TvrUi.update_prog_indicator("plus","Loading Javascript...");var n=$("#plugin-url").attr("rel")+"js/"+e;$.getScript(n).done(function(e,n){if(t=="ACE code editor script"){TvrUi.show_hand_css($("#edit-css-code"))}TvrUi.update_prog_indicator("minus")}).fail(function(e,n,r){TvrUi.update_prog_indicator("minus",["Script failed to load","<p>The "+t+" failed to load.</p><p>"+TvrUi.handle_ajax_error(e,n)+"</p>"])})},ui_reset:function(e){var t=confirm("Are you sure you want to reset all settings?");if(!t){return false}else{var n,r,i,s,o,u,a;n="reset";r=$("#ui-url").attr("rel");i=["Resetting empty folders..."];s="GET";o=$("#resetUrl").attr("rel");TvrUi.general_ajax_submission(n,r,i,s,o)}},clear_styles:function(e,t,n){var r=confirm("Are you sure you want to clear all styles? Note: The page will reload, so please save any unsaved folders/selectors first (Use Control+S keyboard shortcut to save). Also, the hand-coded CSS area won't get cleared. Please do that manually if required.");if(!r){return false}else{var i,s,o,u,a;i="clear";s=$("#ui-url").attr("rel");o=["Clearing styles..."];u="GET";a=$("#clearUrl").attr("rel");TvrUi.general_ajax_submission(i,s,o,u,a)}},restore_rev:function(e){var t=confirm("Are you sure you want to restore previous settings?");if(!t){return false}else{var n,r,i,s,o;n="restore";r=$("#ui-url").attr("rel");i=["Restoring settings..."];s="GET";o=e.attr("rel");TvrUi.general_ajax_submission(n,r,i,s,o)}},update_code_editor_textareas:function(e,t){$("#code-editors-wrap").find("pre.changed").each(function(){var e=$(this);var t=e.attr("rel");var n=TvrEditors[t].getValue();e.prev("textarea").val(n)})},ajax_save_settings:function(e){if(TvrUi.saveInProgress){TvrUi.reSave=true;return false}TvrUi.saveInProgress=true;var t=$("#ui-url").attr("rel");TvrUi.update_prog_indicator("plus","Saving Settings...");TvrUi.update_code_editor_textareas();var n=$("#tvr_microthemer_ui_serialised");$("#tvr-serialised-data").val($("#tvr_microthemer_ui_save, #microthemer_ui_settings_export").serialize());$.ajax({type:"POST",url:t,data:$("#tvr_microthemer_ui_serialised").serialize(),timeout:2e4,error:function(e,t){TvrUi.reSave=false;TvrUi.update_prog_indicator("minus",["Save error","<p>"+TvrUi.handle_ajax_error(e,t)+"</p>"])},success:function(t){if(TvrUi.reSave){TvrUi.reSave=false;TvrUi.ajax_save_settings("save")}var n=$(t);TvrUi.update_prog_indicator("minus");TvrUi.update_prog_indicator("plus","Refreshing Frontend Styles...");window.TvrSharedVars.g_url=n.find("#google-url-to-refresh").text();if(TvrUi.iframe_functions_loaded()){window.frames["viframe"].TvrExportVars.refreshCSS()}else{window.TvrSharedVars.awaitingIframeReloadAfterSave=true}var r=n.find("#microthemer-notice").html();if(r==null){var i=true;var s=$("#log-item-template").clone().removeAttr("id");var o;jQuery.each(jQuery.browser,function(e,t){o+=e+" : "+t+"\n"});$("#error-report-form").find('textarea[name="tvr_php_error"]').val(t).end().find('textarea[name="tvr_serialised_data"]').val($("#tvr-serialised-data").val()).end().find('textarea[name="tvr_browser_info"]').val(o)}else{var s=$(r).find("li.tvr-message");var u=n.find(".script-feedback");$("#script-feedback").html(u)}$("#full-logs").find(".logs").html(s);TvrUi.update_short_status();if(e=="view-css"){TvrUi.ajax_load_css()}if(e=="export"){var a=$("#sanit-export-name").text();if(a){TvrUi.update_packs_obj(TvrCom.readable_name(a));$("#sanit-export-name").text("")}TvrUi.reload_iframe("manage-design-packs",false);TvrUi.close_dialog()}},complete:function(e,t){TvrUi.saveInProgress=false}})},update_packs_obj:function(e){TvrCombo.directories[TvrCombo.directories.length]=e},handle_ajax_error:function(e,t){if(e.status==0){return"Connection Error. Request Failed. Please Try again."}else if(e.status==404){return"Requested URL not found."}else if(e.status==500){return"Internel Server Error."}else if(t=="parsererror"){return"Error.\nParsing JSON Request failed."}else if(t=="timeout"){return"Request Timed out."}else{return"Unknow Error.\n"+e.responseText}},email_error_report:function(){TvrUi.update_prog_indicator("plus","Sending error report...");var e=$("#ui-nonce").text();var t=$("#ui-url").attr("rel");t+="&action=tvr_error_email&_wpnonce="+e;var n=$("#error-report-form").serialize();$.ajax({type:"POST",url:t,data:n,timeout:2e4,error:function(e,t){TvrUi.update_prog_indicator("minus",["Error sending failed","<p>"+TvrUi.handle_ajax_error(e,t)+"</p>"])},success:function(e){TvrUi.update_prog_indicator("minus");var t=$(e);var n=t.find("#microthemer-notice").html();if(n){var r=$(n).find("li.tvr-message")}$("#full-logs").find(".logs").html(r);TvrUi.update_short_status()}})},show_dialog:function(e){TvrUi.close_dialog();var t=e.attr("rel");if(t=="not-yet"){return false}$("#"+t+"-dialog").addClass("show");if(t=="export-to-pack"){var n="";$("#tvr-menu").find(".section-tag").each(function(){var e=TvrUi.get_meta($(this),"section");n+='<li><input type="checkbox" name="export_sections['+e.sectionSlug+']" '+'checked="checked" /> '+'<span class="fake-checkbox on"></span>'+'<span class="folder-icon tvr-icon"></span>'+'<span class="ef-label">'+e.sectionH+"</span></li>"});$("#available-folders").html(n);TvrUi.update_code_editor_textareas();var r=$("#custom-css");$("#hand-css-area").find("textarea.hand-css-textarea").each(function(e){var t=$(this);var n=r.find("."+"custom-"+t.attr("id"));if(TvrCom.hasValue(t.val())){TvrCom.check_fake(n)}else{TvrCom.uncheck_fake(n)}});$("#export_to_pack").val(1);$("#export_pack_name").val("")}if(t=="display-css-code"){TvrUi.ajax_save_settings("view-css")}if(t=="display-revisions"){TvrUi.ajax_load_revisions_table()}if(t=="manage-design-packs"||t=="program-docs"){TvrUi.reload_iframe(t,e)}},close_dialog:function(){$("#tvr").find("div.tvr-dialog").removeClass("show");$("#export_to_pack, #new_pack").val(0)},reload_iframe:function(e,t){if(e=="manage-design-packs"){var n="manage_iframe"}else if(e=="program-docs"){var n="docs_iframe"}var r=$("#"+n);var i=r.attr("rel");if(t&&TvrCom.hasValue(t.attr("data-prop"))){i="http://themeover.com/"+t.attr("data-prop")+"/";var s=true}if(r.attr("data-frame-loaded")!=1||s||TvrCom.isDomEl(t.closest(".dialog-footer"))){window.frames[n].location=i;r.attr("data-frame-loaded",1)}},toggle_help_info:function(e){e.next().slideToggle("fast",function(){})},scroll_to_bottom:function(e){e.scrollTop(e.scrollHeight)},toggle_multi_checkboxes:function(e){var t=$("#available-folders, #custom-css");if(e.hasClass("on")){t.find("input").prop("checked",false).end().find(".fake-checkbox").add(e).removeClass("on")}else{t.find("input").prop("checked",true).end().find(".fake-checkbox").add(e).addClass("on")}},import_settings:function(){if($("#import_from_pack_name").val()==""){alert("Please select a design pack from the list");return false}else if(!$("#ui-import-overwrite").is(":checked")&&!$("#ui-import-merge").is(":checked")){alert("Please choose an import method (overwrite or merge with your current settings)");return false}else{if($("#ui-import-overwrite").is(":checked")){var e="overwrite"}else{var e="merge"}var t,n,r,i,s,o,u;t="import";n=$("#ui-url").attr("rel");r=["Importing Settings ("+e+")..."];i="POST";s=$("#microthemer_ui_settings_import").serialize();TvrUi.general_ajax_submission(t,n,r,i,s)}},general_ajax_submission:function(e,t,n,r,i){var s=-1;TvrUi.update_prog_indicator("plus",n[s++]);$.ajax({type:r,url:t,data:i,timeout:2e4,error:function(t,n){TvrUi.update_prog_indicator("minus",[TvrCom.ucwords(e)+" error","<p>"+TvrUi.handle_ajax_error(t,n)+"</p>"]);TvrUi.close_dialog()},success:function(e){window.location=t}})},export_settings:function(){if(!$("#export_pack_name").val()){alert("Please select an existing settings pack or name a new one to export to");return false}var e=$("#export_pack_name").val().toLowerCase();var t=false;for(var n in TvrCombo.directories){if(TvrCombo.directories[n].toLowerCase()==e){t=true;break}}if(!t){$("#new_pack").val(1)}TvrUi.ajax_save_settings("export")},add_m_query:function(e){var t=e.attr("rel");var n=$("#unq-base").attr("rel");e.attr("rel",++t);var r=$("li.m-query-tpl").clone().removeClass("m-query-tpl").addClass("mq-row-"+t);r.find("input").each(function(e){$(this).attr("name",$(this).attr("name").replace("key",n+t))});$("#mq-list").prepend(r).hide().fadeIn("fast").end().sortable("refresh")},del_m_query:function(e){e.parents("li.mq-row").remove()},reveal_form_opts:function(e){var t=e.attr("rel");e.closest("li").siblings(".hidden."+t).addClass("show")},toggle_folder:function(e){var t=TvrUi.get_meta(e,"section");var n=t.sectionM.find("ul.selector-sub");var r=t.sectionM.find(".menu-arrow");if(r.hasClass("on")){r.removeClass("on");n.hide()}else{r.addClass("on");n.show()}},dom_replacements:function(e,t,n,r,i,s,o,u,a,f){if(e=="section"){t.find("input, select").each(function(e){$(this).attr("name",$(this).attr("name").replace("tvr_mcth["+n+"]","tvr_mcth["+r+"]").replace(/tvr_mcth\[non_section\]\[m_query\]\[([a-zA-Z0-9_]+)\]\[([a-zA-Z0-9_]+)\]/,"tvr_mcth[non_section][m_query][$1]["+r+"]").replace(/tvr_mcth\[non_section\]\[(important|view_state|display_name)\]\[([a-zA-Z0-9_]+)\]/,"tvr_mcth[non_section][$1]["+r+"]"))});t.find(".section-name .name-text").text(i);t.find(".section-display-name").val(i);t.find(".rename-input").val(i);t.find(".selector-tag, .group-tag, .property-tag").add(t).each(function(){$(this).attr("id",$(this).attr("id").replace(n,r))})}if(e=="selector"){t.find(".selector-name").attr("title",TvrCom.regular_escape_quotes(a));t.find(".selector-name .name-text").text(u);t.find(".selector-label").val(u+"|"+a);t.find(".selector-name-input").val(u);t.find(".selector-css-textarea").val(a)}if(e=="group"){t.removeAttr("id");t.attr("class",t.attr("class").replace("property-fields-all-devices","property-fields-"+f));if(f!="all-devices"){t.find(".property-input").each(function(e){$(this).attr("name",$(this).attr("name").replace("tvr_mcth","tvr_mcth[non_section][m_query]["+f+"]"))}).end().find(".important-toggle").each(function(){$(this).removeClass("imp-reg").addClass("imp-mq")}).end().find(".property-tag").each(function(){$(this).attr("id",$(this).attr("id").replace("-all-devices","-"+f))})}}if(e=="selector"||e=="group"){t.find("input, select").each(function(e){$(this).attr("name",$(this).attr("name").replace("tvr_mcth["+n+"]["+s+"]","tvr_mcth["+r+"]["+o+"]").replace(/tvr_mcth\[non_section\]\[m_query\]\[([a-zA-Z0-9_]+)\]\[([a-zA-Z0-9_]+)\]\[([a-zA-Z0-9_]+)\]/,"tvr_mcth[non_section][m_query][$1]["+r+"]["+o+"]").replace(/tvr_mcth\[non_section\]\[(important|view_state|display_name)\]\[([a-zA-Z0-9_]+)\]\[([a-zA-Z0-9_]+)\]/,"tvr_mcth[non_section][$1]["+r+"]["+o+"]"))});t.find(".selector-tag, .group-tag, .property-tag").add(t).each(function(){try{$(this).attr("id",$(this).attr("id").replace(n+"-"+s,r+"-"+o))}catch(e){}})}return t},add_section:function(e){var t=TvrCom.ucwords(e.siblings(".new-section-input").val());var n=TvrCom.new_name_checks(t,"folder");if(!n){return false}var r=TvrUi.dom_replacements("section",$("#strk-selector_section").add($("#opts-selector_section")).clone(),"selector_section",n["newName"],n["newNameHuman"]);$("#tvr-options").prepend(r[1]);$("#tvr-menu").prepend(r[0]).hide().fadeIn("fast",function(){$("#add-new-section").find("input.new-section-input").val("");var e=$("#section-count-state");TvrUi.update_count(e,"add",1,"section")});TvrCom.refresh_sortable()},load_section_selectors:function(e,t){var n=e.sectionM.find('input.selector-tracker[value="0"]');TvrUi.selsToLoad=n.length;TvrUi.totalToLoad=TvrUi.selsToLoad;if(TvrUi.selsToLoad>0){if(TvrUi.action_in_prog(e.sectionM,"all-sels-loading")){return true}TvrUi.log_action(e.sectionM,"all-sels-loading");TvrUi.com_data_loading(e.sectionM,"sec");n.each(function(){e=TvrUi.get_meta($(this),"selector");TvrUi.ajax_load_ui_data(e.selector,e.sectionM,e.selectorT,e.sectionSlug,e.selectorSlug,"selector",3,t)});return true}else{return false}},toggle_rename_section:function(e){var t=TvrUi.get_meta(e,"section");if(!TvrUi.action_in_prog(t.sectionM,"rename")&&!TvrUi.action_in_prog(t.sectionM,"data-load")&&!TvrUi.load_section_selectors(t,"sec rename, load styles discretely")){TvrUi.log_action(t.sectionM,"rename");var t=TvrUi.get_meta(e,"section");$form=t.sectionM.find(".edit-section-form");$name=t.sectionM.find(".section-name");if(!$form.hasClass("show")){$name.hide();$form.addClass("show")}else{$name.show();$form.removeClass("show")}TvrUi.unlog_action(t.sectionM,"rename")}},action_rename_section:function(e){var t=TvrUi.get_meta(e,"section");var n=TvrCom.ucwords(t.sectionM.find(".rename-input").val());if(TvrCom.convert_to_param(n)==t.sectionSlug){var r=[];r["newName"]=t.sectionSlug;r["newNameHuman"]=n}else{var r=TvrCom.new_name_checks(n,"folder");if(!r){return false}}var i=r["newName"];var s=r["newNameHuman"];var o=t.sectionSlug;var u=t.sectionM.add(t.section);TvrUi.dom_replacements("section",u,o,i,s);t=TvrUi.get_meta($("#strk-"+i),"section");TvrUi.toggle_rename_section(t.sectionM);if(TvrUi.selInFocusID.indexOf("opts-"+o)>=0){TvrUi.update_global_vars(TvrUi.get_meta(t.section.find("li.in-focus"),"selector"))}},copy_section:function(e){var t=TvrUi.get_meta(e,"section");if(!TvrUi.action_in_prog(t.sectionM,"copy")&&!TvrUi.load_section_selectors(t,"sec copy, load styles discretely")){TvrUi.log_action(t.sectionM,"copy");var n=TvrCom.resolve_unique_name(t.sectionH,$("#tvr-menu"),".section-name","Copy");var r=TvrUi.dom_replacements("section",TvrUi.proper_clone(t.section.add(t.sectionM)),t.sectionSlug,TvrCom.convert_to_param(n),n);r.removeAttr("copy-in-prog").find("li.in-focus").removeClass("in-focus");r.find("img.ajax-loader").remove();t.sectionM.after(r[0]);t.section.after(r[1]);var i=$("#section-count-state");var s=t.sectionM.find("span.selector-count-state").attr("rel");TvrUi.update_count(i,"add",1,"section",s);TvrUi.unlog_action(t.sectionM,"copy");if(TvrCom.hasValue(TvrUi.selInFocusID)){TvrUi.update_visual_controls($("#"+TvrUi.selInFocusID))}}},action_in_prog:function(e,t){if(TvrCom.hasValue(e.attr(t+"-in-prog"))){return true}else{return false}},log_action:function(e,t){e.attr(t+"-in-prog",1)},unlog_action:function(e,t){e.removeAttr(t+"-in-prog")},delete_section:function(e){var t=TvrUi.get_meta(e,"section");if(TvrUi.action_in_prog(t.sectionM,"delete")||TvrUi.action_in_prog(t.sectionM,"all-sels-loading")){return false}TvrUi.log_action(t.sectionM,"delete");t.sectionM.fadeOut("fast",function(){var e=t.sectionM.find("span.selector-count-state").attr("rel");TvrUi.update_count($("#section-count-state"),"subtract",1,"section",e);if(TvrCom.hasValue(TvrUi.selInFocusID)&&t.sectionSlug==TvrUi.section_slug(TvrUi.selInFocusID)){if(TvrUi.expanded("quick_section")){TvrUi.close_quick_edit()}var n=TvrUi.selectorTrackerScan(t.sectionM,"next");if(!TvrCom.isDomEl(n)){n=TvrUi.selectorTrackerScan(t.sectionM,"prev")}if(TvrCom.isDomEl(n)){var r=true;var i=TvrUi.get_meta(n,"selector");TvrUi.tvr_iterate_selectors_v(i.selectorT)}else{var r=false}}t.section.remove();t.sectionM.remove()})},toggle_add_selector:function(e){var t=TvrUi.get_meta(e,"section");var n=t.sectionM.find(".add-selector-form");if(n.hasClass("show")){n.removeClass("show");n.find("textarea.selector-css, input.selector-label").val("")}else{n.addClass("show")}if(!t.sectionM.find(".menu-arrow").hasClass("on")){TvrUi.toggle_folder(t.sectionM)}},selector_checks_values:function(e,t,n){var r=TvrCom.ucwords(e.val());if(r==""){alert("Please enter a value for the Selector name");return false}if(TvrCom.convert_to_param(r)==n){var i=[];i["newName"]=n;i["newNameHuman"]=r}else{var i=TvrCom.new_name_checks(r,"selector");if(!i){return false}}if(!t){alert("Please enter some CSS selector code e.g. #header");return false}i["code"]=t;return i},show_hide_sel_custom:function(e,t){var n=TvrUi.analyse_sel_code(e);if(n["custom_styles"]){t.addClass("custom-styles")}else{t.removeClass("custom-styles")}},analyse_sel_code:function(e){var t=[];if(e.indexOf("{")>=0){t["custom_styles"]=true;var n=e.split("{");t["code"]=n[0]}else{t["custom_styles"]=false;t["code"]=e}return t},add_selector:function(e){if(!TvrUi.allowed_action(e,"Add Sel")){return false}var t=TvrUi.get_meta(e,"section");var n=TvrUi.selector_checks_values(t.sectionM.find(".add-selector-form .selector-name-input"),t.sectionM.find(".add-selector-form .selector-css-textarea").val(),false);if(!n){return false}var r=TvrUi.dom_replacements("selector",$("#strk-selector_section-selector_css").add($("#opts-selector_section-selector_css")).clone(),"selector_section",t.sectionSlug,t.sectionM.find(".name-text").text(),"selector_css",n["newName"],n["newNameHuman"],n["code"]);r.find(".view-state-input").val(1);t.sectionM.find(".add-selector-list-item").after(r[0]);t.section.find(".opts-selectors-sub").prepend(r[1]);TvrUi.update_count(t.sectionM.find(".selector-count-state"),"add",1,"selector","");t=TvrUi.get_meta(t.section.find(".selector-tag").first(),"selector");TvrUi.tvr_iterate_selectors_v(t.selectorT);TvrUi.pg_icon_pressed(t.selector.find(".pg-icon-font"));TvrCom.refresh_sortable();TvrUi.show_hide_sel_custom(n["code"],t.selectorM.find(".selector-name"));TvrUi.toggle_add_selector(t.sectionM.find(".reveal-add-selector"));TvrUi.meta.sectionM.find(".add-selector-form").find(".selector-name-input, .selector-css-textarea").val("");if(window.TvrSharedVars.intelli){TvrUi.hide_wizard()}},load_selector:function(e,t){if(e.selectorT.val()==0&&!TvrUi.action_in_prog(e.selectorM,"data-load")){TvrUi.com_data_loading(e.selectorM,"sel");TvrUi.ajax_load_ui_data(e.selector,e.selectorM,e.selectorT,e.sectionSlug,e.selectorSlug,"selector",1,t);return true}else{return false}},toggle_modify_selector:function(e){var t=TvrUi.get_meta(e,"selector");if(!TvrUi.action_in_prog(t.selectorM,"rename")&&!TvrUi.action_in_prog(t.selectorM,"data-load")&&!TvrUi.load_selector(t,"load selector before modifying")){TvrUi.log_action(t.selectorM,"rename");var n=t.selectorM.find(".edit-selector-form");if(n.hasClass("show")){n.removeClass("show");if(TvrUi.expanded("quick_selector")){TvrUi.close_quick_edit()}}else{n.addClass("show")}TvrUi.unlog_action(t.selectorM,"rename")}},action_modify_selector:function(e){var t=TvrUi.get_meta(e,"selector");var n=TvrUi.selector_checks_values(t.selectorM.find(".selector-name-input"),t.selectorM.find(".selector-css-textarea").val(),t.selectorSlug);if(!n){return false}var r=n["newName"];var i=n["newNameHuman"];var s=t.sectionSlug;var o=t.selectorM.add(t.selector);TvrUi.dom_replacements("selector",o,s,s,t.sectionH,t.selectorSlug,r,i,n["code"]);if(TvrUi.selInFocusID==t.selectorID){TvrUi.update_global_vars(TvrUi.get_meta(t.section.find("li.in-focus"),"selector"))}TvrUi.show_hide_sel_custom(n["code"],t.selectorM.find(".selector-name"));window.TvrSharedVars.curSelCSS=TvrCom.custom_escape_quotes(n["code"]);if(TvrUi.iframe_functions_loaded()){window.frames["viframe"].TvrExportVars.switch_highlight("reg")}TvrUi.ajax_save_settings("save");TvrUi.toggle_modify_selector(t.selectorM);if(TvrUi.expanded("quick_selector")){TvrUi.close_quick_edit()}},proper_clone:function(e){var t=e.clone();e.find("select.property-input").each(function(e){t.find("select.property-input").eq(e).val($(this).val())});TvrUi.jscolor_bind(t);return t},copy_selector:function(e){if(!TvrUi.allowed_action(e,"Add Sel")){return false}var t=TvrUi.get_meta(e,"selector");if(!TvrUi.action_in_prog(t.selectorM,"copy")&&!TvrUi.action_in_prog(t.selectorM,"data-load")&&!TvrUi.load_selector(t,"load selector before copying")){TvrUi.log_action(t.selectorM,"copy");var n=TvrCom.resolve_unique_name(t.selectorH,t.sectionM,".selector-name","Copy");var r=TvrUi.dom_replacements("selector",TvrUi.proper_clone(t.selector.add(t.selectorM)),t.sectionSlug,t.sectionSlug,t.sectionH,t.selectorSlug,TvrCom.convert_to_param(n),n,t.selectorM.find(".selector-css-textarea").val());r.removeClass("in-focus").removeAttr("copy-in-prog").find("img.ajax-loader").remove();t.selectorM.after(r[0]);t.selector.after(r[1]);TvrUi.update_count(t.sectionM.find(".selector-count-state"),"add",1,"selector","");TvrUi.unlog_action(t.selectorM,"copy");if(TvrCom.hasValue(TvrUi.selInFocusID)){TvrUi.update_visual_controls($("#"+TvrUi.selInFocusID))}}},delete_selector:function(e){var t=TvrUi.get_meta(e,"selector");if(TvrUi.action_in_prog(t.selectorM,"delete")||TvrUi.action_in_prog(t.selectorM,"data-load")){return false}TvrUi.log_action(t.selectorM,"delete");t.selectorM.fadeOut("fast",function(){TvrUi.update_count(t.sectionM.find(".selector-count-state"),"subtract",1,"selector","");if(t.selectorID==TvrUi.selInFocusID){if(TvrUi.expanded("quick_selector")){TvrUi.close_quick_edit()}var e=TvrUi.selectorTrackerScan(t.sectionM,"next","selector",t.selectorM);if(!TvrCom.isDomEl(e)){e=TvrUi.selectorTrackerScan(t.sectionM,"prev","selector",t.selectorM)}if(TvrCom.isDomEl(e)){var n=true;var r=TvrUi.get_meta(e,"selector");TvrUi.tvr_iterate_selectors_v(r.selectorT)}else{var n=false}}t.selector.remove();t.selectorM.remove();if(!n){TvrUi.update_visual_controls(false)}})},add_property_group:function(e){var t=TvrUi.get_meta(e,"group");var n=e.attr("rel").split("|");var r=n[0];var i=n[1];var s=t.group.find(".mq-button.on").length;var o=TvrUi.dom_replacements("group",$("#option-group-template-"+t.groupSlug).clone(),"selector_section",t.sectionSlug,t.sectionM.find(".name-text").text(),"selector_css",t.selectorSlug,t.selectorH,"",r);TvrUi.jscolor_bind(o);t.group.append(o);var u=t.group.find(".mq-tab-"+r);u.addClass("show");TvrUi.mq_tab_pressed(u);if(s==0){t.selector.find(".pg-icon-"+t.groupSlug).addClass("on").find(".main-checkbox").prop("checked",true);TvrUi.update_count(t.selector.find(".style-count-state"),"add",1,"style")}t.group.find(".mqb-"+r).addClass("on").find(".style-config").prop("checked",true);TvrUi.update_mq_button($("#mq-button-"+r))},remove_property_group:function(e,t){var n=TvrUi.get_meta(e,"group");if(t=="delete-all"){var r=n.group.find(".property-fields");var i=n.group.find(".mq-button");var s=n.group.find("span.mq-tab");var o=n.group.find(".style-config")}else{var u=e.attr("rel").split("|");var a=u[0];var r=n.group.find(".property-fields-"+a);var i=e.parent(".mq-button");var s=n.group.find("span.mq-tab-"+a);var o=n.group.find(".mqb-"+a).find(".style-config");var f=false;if(s.hasClass("active")){f=true}}r.remove();i.removeClass("on");s.removeClass("show active");o.prop("checked",false);var l=n.group.find(".mq-button.on").length;if(l==0){n.selector.find(".pg-icon-"+n.groupSlug).removeClass("on").find(".main-checkbox").prop("checked",false);TvrUi.update_count(n.selector.find(".style-count-state"),"subtract",1,"style");n.selector.find(".pg-focus").val("")}if(l>0&&f){TvrUi.mq_tab_pressed(n.group.find("span.mq-tab.show:eq(0)"))}TvrUi.ajax_save_settings("save")},update_accordion:function(e,t){var n=t.find("li.accordion-item");var r=e.parent();if(r.hasClass("show-content")){var i=true}t.find(".accordion-menu-arrow.on").removeClass("on");n.slideUp(function(){t.find(".show-content").removeClass("show-content")});if(i){return false}else{r.find(".accordion-menu-arrow").addClass("on");e.siblings("li.accordion-item").slideDown(function(){r.addClass("show-content")});return false}},pg_icon_pressed:function(e){if(!TvrUi.allowed_action(e,"Edit Sel")){return false}var t=e.attr("rel");window.TvrSharedVars.pgInFocus=t;var n=TvrUi.get_meta(e,"selector");n=TvrUi.get_meta($("#opts-"+n.sectionSlug+"-"+n.selectorSlug+"-"+t),"group");if(!e.hasClass("on")){TvrUi.add_property_group(n.group.find(".mqb-all-devices").find(".mq-add-remove"))}var r=n.selector.find(".styling-options");var i=".group-tag";var s=n.selector.find(".styling-option-icons");var o=".pg-icon";var u=".pg-focus";TvrUi.update_tab(r,i,s,t,o,u);TvrUi.update_mq_button($("#mq-button-"+n.group.find(".device-focus").val()));if(TvrUi.iframe_functions_loaded()){window.frames["viframe"].TvrExportVars.get_computed_styles(window.TvrSharedVars.curSelCSS,"str")}TvrUi.refresh_comp_css();TvrUi.toolbar_adjusted()},show_add_mq:function(e){if(TvrUi.itemAlreadyExpanded){return false}e.addClass("on").parent().addClass("expanded on")},hide_add_mq:function(e){var t=$("#"+TvrUi.selInFocusID);if(!TvrCom.isDomEl(t)){return false}var n=TvrUi.get_meta($("#"+TvrUi.selInFocusID),"selector");n.selector.find("span.add-mq").removeClass("expanded on").find(".add-mq-icon").removeClass("on")},toggle_pg_fields:function(e){var t=TvrUi.get_meta(e,"group");if(e.parent(".mq-button").hasClass("on")){TvrUi.remove_property_group(e)}else{TvrUi.add_property_group(e)}},update_tab:function(e,t,n,r,i,s){n.find(i).removeClass("active").end().find(i+"-"+r).addClass("active").end().find(s).val(r);e.find(t+".show").removeClass("show").end().find(t+"-"+r).addClass("show");if(i==".mq-tab"){TvrUi.update_mq_button($("#mq-button-"+r))}},mq_tab_pressed:function(e){var t=TvrUi.get_meta(e,"group");var n=t.group;var r=".property-fields";var i=t.group.find(".query-tabs");var s=e.attr("rel");var o=".mq-tab";var u=".device-focus";TvrUi.update_tab(n,r,i,s,o,u)},css_tab_pressed:function(e){var t=$("#hand-css-area");var n=".css-code-wrap";var r=t.find(".css-code-tabs");var i=e.attr("rel");var s=".css-tab";var o=".css-focus";TvrUi.update_tab(t,n,r,i,s,o)},adv_tab_pressed:function(e){var t=$("#advanced-wizard");var n=".adv-area";var r=t.find(".adv-tabs");var i=e.attr("rel");var s=".adv-tab";var o=".adv-wizard-focus";TvrUi.update_tab(t,n,r,i,s,o);if(e.hasClass("adv-tab-html-inspector")){TvrUi.adjust_wiz_comp_height()}},combobox_clicked:function(e){e.autocomplete("search","").next(".combo-arrow").addClass("on")},update_wizard_slider:function(e){var t=26;var n=t*e;var r=e;$("#code-suggestion-slider").height(n-t-t).slider({orientation:"vertical",min:1,step:1,max:r,value:r,create:function(e,t){$("#advanced-wizard").find(".scrollable-refined").scrollTop(0)},slide:function(e,t){$("#code-suggestions").find("li.in-focus").removeClass("in-focus");$("#code-suggestion-"+t.value).addClass("in-focus");window.TvrSharedVars.intelli_css=$("#code-suggestion-"+t.value).text();if(TvrUi.iframe_functions_loaded()){window.frames["viframe"].TvrExportVars.switch_highlight("intelli")}},change:function(e,t){TvrUi.autoScroll(t.value)}})},autoScroll:function(e){var t=$("#advanced-wizard").find(".scrollable-refined");var n=136;var r=$("#code-suggestion-"+e);var i=r.position().top;if(i<13||i>n-13){t.animate({scrollTop:i},"500")}},update_iframe_slider:function(e,t){if(e&&!t){var n=e}else if(t){var n=t}else{var n=TvrUi.frameWidth}$("#v-frontend").width(n);$("#iframe-pixel-width").text(n+"px");if(e){$("#iframe-min-width").text("min: "+e+"px");var r=e}else{$("#iframe-min-width").text("");var r=0}if(t){$("#iframe-max-width").text("max: "+t+"px");var i=t}else{$("#iframe-max-width").text("");var i=TvrUi.fullWidth}$("#v-mq-slider").slider({min:r,max:i,value:n,start:function(e,t){if(window.TvrSharedVars.highlightEnabled){TvrUi.hide_highlighting();window.TvrSharedVars.tmpHideHighlighting=true}},slide:function(e,t){var n=$("#v-mq-slider").slider("option","value");$("#v-frontend").width(n);$("#iframe-pixel-width").text(n+"px")},change:function(e,t){if($("#visual-view").hasClass("show-wizard")){var n="intelli"}else{var n="reg"}if(window.TvrSharedVars.tmpHideHighlighting){TvrUi.show_highlighting()}TvrUi.screen_width_adjusted(n)}});TvrUi.iframe_slider_set=true},update_mq_button:function(e){var t=e.attr("rel");$("#v-mq-buttons").find("span.active").removeClass("active");e.addClass("active");TvrUi.update_iframe_slider(TvrUi.mqMin[t],TvrUi.mqMax[t])},screen_width_adjusted:function(e){if(TvrUi.iframe_functions_loaded()){window.frames["viframe"].TvrExportVars.switch_highlight(e);window.frames["viframe"].TvrExportVars.get_computed_styles(window.TvrSharedVars.curSelCSS,"str")}TvrUi.refresh_comp_css()},map_formatted_comp:function(e,t,n,r,i,s,o,u,a){if(a){var f=window.TvrSharedVars.intelliCompProps}else{var f=window.TvrSharedVars.compProps}if(n=="straight"){if(t=="var"){f[e[r]]=s}else{if(i==0){f[e[r]]=[]}f[e[r]][i]=[];f[e[r]][i]["val"]=s;f[e[r]][i]["htmlString"]=o}}if(n=="array"){var l=-1;var c=e[r];for(var h in c){if(t=="var"){f[c[h]]=u[++l]}else{if(i==0){f[c[h]]=[]}f[c[h]][i]=[];f[c[h]][i]["val"]=u[++l];f[c[h]][i]["htmlString"]=o}}}if(a){window.TvrSharedVars.intelliCompProps=f}else{window.TvrSharedVars.compProps=f}},format_exceptions:function(e,t,n,r,i,s){if(i=="var"){var o=n}else{var o=n[r]["val"];var u=n[r]["htmlString"]}if(!TvrCom.hasValue(o)){return false}if(t=="font-family"||t=="list-style-type"||t=="border-top-left-radius"||t=="border-top-right-radius"||t=="border-bottom-right-radius"||t=="border-bottom-left-radius"){TvrUi.map_formatted_comp(e,i,"straight",t,r,o,u,[],s)}else if(t=="text-shadow"||t=="box-shadow"){var a=o.split(" ");if(a.length<2){a[1]=a[2]=a[3]=0}TvrUi.map_formatted_comp(e,i,"array",t,r,o,u,a,s)}else if(t=="list-style-image"){TvrUi.map_formatted_comp(e,i,"straight",t,r,TvrCom.basename(o),u,[],s)}else if(t=="background-img-full"){var f=[];f[0]=TvrCom.extract_str("bg-image",o);var l=TvrCom.extract_str("gradient",o);if(l){var c=/gradient\((.+)\)/.exec(l);if(c){var h=c[1].split(", ");if(o.indexOf("webkit")>=0){var p="webkit-";var d=" (webkit standard)"}else{var p="";var d=""}if(h[0].indexOf("deg")>-1){var v=e["keys"][p+"gradient-angle"][h[0]];var m=true;var g=1}else{var v="top to bottom";var m=false;var g=0}if(v){f[1]=v}else{f[1]=h[0]+d}f[2]=h[g];if(m&&h.length>3||!m&&h.length>2){var y=h[++g].split(" ");f[3]=y[0];f[4]=y[1];f[5]=h[++g]}else{f[3]="none";f[4]="0";f[5]=h[++g]}}else if(l.indexOf("svg")>-1){f[1]="IE9 can't report";f[2]="IE9 can't report";f[3]="IE9 can't report";f[4]="IE9 can't report";f[5]="IE9 can't report"}}else{f[1]="none";f[2]="none";f[3]="0";f[4]="none";f[5]="none"}TvrUi.map_formatted_comp(e,i,"array",t,r,o,u,f,s)}else if(t=="background-position"){var b=o.split(", ");var w=b[0].split(" ");var E=e["keys"]["background-position-x"][w[0]];var S=e["keys"]["background-position-y"][w[1]];var x=E?E:w[0];var T=S?S:w[1];var N=x+" "+T;var C=[x,T];TvrUi.map_formatted_comp(e,i,"straight",t,r,N,u,[],s);TvrUi.map_formatted_comp(e,i,"array","background-position-custom",r,o,u,C,s)}else if(t=="background-repeat"||t=="background-attachment"||t=="background-size"||t=="background-clip"){var b=o.split(", ");TvrUi.map_formatted_comp(e,i,"straight",t,r,b[0],u,[],s)}},filter_css_exceptions:function(e){if(e){var t=window.TvrSharedVars.intelliCompProps}else{var t=window.TvrSharedVars.compProps}var n=TvrPropExceptions;var r=0;for(var i in t){++r;var s=t[i];if(s===Object(s)){for(var o in s){TvrUi.format_exceptions(n,i,s,o,"obj",e)}}else{TvrUi.format_exceptions(n,i,s,"","var",e)}}return r},refresh_comp_css:function(){if(!TvrUi.iframe_functions_loaded()){return false}var e=TvrUi.filter_css_exceptions(false);var t=$("#"+TvrUi.selInFocusID);if(!TvrCom.isDomEl(t)){return false}if(e<1){var n="This Selector doesn't target any elements on the current page";t.find("input.property-input, select.property-input").attr("title",n);t.find("div.field-wrap").removeClass("mixed-cp").find("span.comp-style").text("");return}if(window.parent.TvrSharedVars.pgInFocus!=""){var r=t.find("li.group-tag-"+window.parent.TvrSharedVars.pgInFocus).find("div.field-wrap")}else{var r=t.find("div.field-wrap")}r.each(function(e){var t=$(this);if(t.hasClass("group-label")||t.hasClass("sub-label")){return}var n=t.find("span.comp-style");var r=t.find(".property-input");var i=n.attr("class").split(" ");var s=i[1].replace("cprop-","");var o=window.TvrSharedVars.compProps[s];var u=0;if(TvrCom.isDefined(o)){if(o===Object(o)){t.addClass("mixed-cp");n.text("[mix]");var a="The computed value for this style varies across multiple elements on the current page";var f="";for(var l in o){if(!TvrCom.isDefined(o[l]["val"])){continue}var c=o[l]["htmlString"].replace("&#60;","<").replace("&#62;",">");f+='<tr class="mixed-val" rel="'+u+'"><td>'+ ++u+"</td><td title='"+c+"'>"+TvrUi.colorize_hash(o[l]["val"],t,"obj")+"</td></tr>"}t.find("span.comp-mixed-table").find("tbody").html(f)}else{var a="Computed value: "+o;t.removeClass("mixed-cp");o=TvrUi.truncate_displayed_comp_css(r,o);n.html(TvrUi.colorize_hash(o,t,"val"))}}else{var a="Style not applicable";n.text("")}r.attr("title",a)})},truncate_displayed_comp_css:function(e,t){var n=e.width();var r=t.length;var i=n/6;if(r>i){t=t.substring(0,i)+"..."}return t},colorize_hash:function(e,t,n){if(!e||e.indexOf("#")<0){if(n!="obj"){t.removeClass("colorize-hash")}return e}else{if(n!="obj"){t.addClass("colorize-hash")}var r=e;return e.replace("#",'<span class="colored-hash" style="background:'+r+'">#</span>')}},update_prog_indicator:function(e,t){if(window.TvrSharedVars.progCount<0){window.TvrSharedVars.progCount=0;return false}var n=$("#m-logo");var r=$("#status-short");var i=$("#dialogs").find(".tvr-dialog").find(".dialog-icon");if(e=="plus"){++window.TvrSharedVars.progCount;r.removeClass();n.add(r).add(i).addClass("active");r.text(t)}else{--window.TvrSharedVars.progCount;if(window.TvrSharedVars.progCount<=0){n.add(r).add(i).removeClass("active");TvrUi.update_full_logs(t)}}},update_full_logs:function(e){var t=$("#full-logs").find(".logs");if(e){var n=e[0];var r=e[1];if(!e[2]){var i="error"}else{var i=e[2]}var s=$("#log-item-template").clone().removeAttr("id");s.attr("class",s.attr("class").replace("tvr-error","tvr-"+i)).find(".short").text(n).end().find(".long").html(r);t.html(s)}TvrUi.update_short_status()},update_short_status:function(){var e=$("#full-logs").find(".logs li").first();if(e){var t=e.find(".short").text();var n=e.attr("class")}else{var t,n=""}$("#status-short").addClass(n).text(t)},default_to_first_sel:function(){var e=$("#last-edited-selector").val();if(e&&$("#"+e)){var t=$("#"+e)}else{var t=$("#tvr-menu").find("li.selector-tag:eq(0)")}if(t&&TvrCom.hasValue(t.attr("id"))){TvrUi.tvr_iterate_selectors_v(t)}else{return false}},adjust_comp_span:function(e,t){if(t=="after"){if(!e.val()){e.closest(".property-tag").removeClass("manual-val");e.siblings("span.comp-style").removeClass("hidden")}else{e.closest(".property-tag").addClass("manual-val");e.siblings("span.comp-style").addClass("hidden")}TvrUi.signal_if_pg_has_values(e)}else if(t=="hover"){e.siblings("span.comp-style").addClass("hidden")}},signal_if_pg_has_values:function(e){var t=TvrUi.get_meta(e,"group");var n=true;t.group.find("input.property-input").each(function(e){if($(this).val()){n=false;return}});var r=t.selector.find("li.pg-icon-"+t.groupSlug);if(n){r.removeClass("hasValues")}else{r.addClass("hasValues")}},done_typing:function(){TvrUi.ajax_save_settings("save")},toggle_left_menu:function(){$("#v-left-controls").slideToggle("fast",function(){if(TvrUi.leftMenu){$("#toggle-left-menu").removeClass("showing");TvrUi.leftMenu=false}else{$("#toggle-left-menu").addClass("showing");TvrUi.leftMenu=true}})},get_folders:function(){var e=[];$("#tvr-menu").find(".section-tag").each(function(t){var n=TvrUi.get_meta($(this),"section");e[t]=n.sectionH});return e},show_wizard:function(){window.TvrSharedVars.intelli=true;$("#visual-view").addClass("show-wizard");if($("#always-adv-checkbox").is(":checked")){TvrUi.show_adv_wizard()}if(TvrUi.leftMenu){TvrUi.toggle_left_menu()}TvrCombo.cur_folders=TvrUi.get_folders();if(TvrCom.hasValue(TvrUi.selInFocusID)){var e=TvrUi.get_meta($("#"+TvrUi.selInFocusID),"selector");$("#wizard_folder").val(e.sectionH).removeClass("text-label")}TvrUi.update_selector_wizard()},hide_wizard:function(){$("#visual-view").removeClass("show-wizard");TvrUi.hide_adv_wizard();TvrUi.return_normal_highlighting();$("#wizard-name").val("");window.TvrSharedVars.intelli=false;TvrUi.toolbar_adjusted()},toggle_adv_wizard:function(){if(!$("#visual-view").hasClass("show-advanced")){TvrUi.show_adv_wizard()}else{TvrUi.hide_adv_wizard()}TvrUi.toolbar_adjusted()},show_adv_wizard:function(){$("#visual-view").addClass("show-advanced");var e=$("#v-frontend-wrap");var t=e.height()-40;e.find(".wizard-panes").height(t);TvrUi.screen_width_adjusted("intelli")},hide_adv_wizard:function(){$("#visual-view").removeClass("show-advanced");TvrUi.screen_width_adjusted("intelli")},switch_html_element:function(e){var t=e.attr("class");var n=window.TvrSharedVars.TvrSugCSS;if(t.indexOf("tvr-parent")>=0){var r=n["Intelli"]["parent"]}else if(t.indexOf("tvr-child")>=0){var r=n["Intelli"]["child"]}else if(t.indexOf("tvr-prev-sibling")>=0){var r=n["Intelli"]["prev"]}else if(t.indexOf("tvr-next-sibling")>=0){var r=n["Intelli"]["next"]}if(TvrUi.iframe_functions_loaded()){window.frames["viframe"].TvrExportVars.build_selector_suggestions(r)}},update_selector_wizard:function(){var e=$("#advanced-wizard");var t=window.TvrSharedVars.TvrSugCSS;var n="";var r=0;var i=1;var s=1;var o=0;for(var u in t){if(u=="Intelli"){break}++r;if(r==t["Intelli"]["ogCount"]){var a=" (highest specificity)"}else{var a=""}n+='<li class="selector-category">'+u+a+"</li>";for(key2 in t[u]){if(window.TvrSharedVars.intelli_css==key2){var f='in-focus"'}else{var f=""}n+='<li id="code-suggestion-'+s+'" class="code-suggestion '+f+"\"             title='"+t[u][key2]+"'><textarea>"+key2+"</textarea></li>";s=s+i;++o}}$("#code-suggestions").html($(n).get().reverse());TvrUi.update_wizard_slider(o);e.find("div.refine-target-controls span").addClass("disabled");e.find("div.refine-target-controls span").each(function(e){var n=$(this);var r=n.attr("class");if(r.indexOf("tvr-parent")>=0&&t["Intelli"]["parent"]){n.removeClass("disabled")}else if(r.indexOf("tvr-child")>=0&&t["Intelli"]["child"]){n.removeClass("disabled")}else if(r.indexOf("tvr-prev-sibling")>=0&&t["Intelli"]["prev"]){n.removeClass("disabled")}else if(r.indexOf("tvr-next-sibling")>=0&&t["Intelli"]["next"]){n.removeClass("disabled")}});e.find("div.refine-target-html span").html(t["Intelli"]["htmlString"]);TvrUi.adjust_wiz_comp_height();TvrUi.refresh_wizard_comp_css()},adjust_wiz_comp_height:function(){var e=$("#advanced-wizard").find(".wizard-panes").height()-$("#refine-target").height()-36;$("#html-computed-css").add($("#html-computed-css").find(".scrollable-area")).css("max-height",e)},refresh_wizard_comp_css:function(){TvrUi.filter_css_exceptions("intelli");var e=window.TvrSharedVars.intelliCompProps=TvrUi.un_flatten_css(window.TvrSharedVars.intelliCompProps);var t=$("#html-computed-css");t.find("li.property-item").remove();for(var n in e){var r="";var i=1;for(var s in e[n]){if(TvrCom.isOdd(i)){var o="row-odd"}else{var o="row-even"}var u=s.replace(/-/g," ");r+='<li class="property-item accordion-item '+o+'">';r+='<span class="comp-prop-label">'+u+":</span> ";r+='<span class="comp-prop-value">'+e[n][s]+"</span>";r+="</li>";++i}r+='<li class="property-item accordion-item bottom-gap"></li>';$("#comp-"+n).append(r)}},un_flatten_css:function(e){var t=[];for(var n in window.parent.TvrSharedVars.cssProps){t[n]=[];for(var r in window.parent.TvrSharedVars.cssProps[n]){var i=window.parent.TvrSharedVars.cssProps[n][r];if(i=="background-img-full"||i=="extracted-gradient"||i=="google-font"||i=="text-shadow"||i=="box-shadow"||i=="background-image"&&n=="gradient"){continue}t[n][i]=e[i]}}return t},wizard_new_selector:function(e){var t=$("#wizard_folder").val();if(!TvrCom.hasValue(t)||t=="Enter new or select a folder..."){alert("Please select an existing folder or enter a new folder name");return false}var n=TvrCom.convert_to_param(t);var r=$("#wizard-name").val();var i=$("#code-suggestions").find("li.in-focus textarea").val();if(!TvrCom.isDomEl($("#strk-"+n))){var s=$("#add-new-section").find(".new-section-input");s.val(t);TvrUi.add_section(s.siblings(".new-section-add"))}var o=TvrUi.get_meta($("#strk-"+n),"section");o.sectionM.find(".add-selector-form").find(".selector-name-input").val(r);o.sectionM.find(".add-selector-form").find(".selector-css-textarea").val(i);TvrUi.add_selector(o.sectionM)},load_visual_view:function(e){var t=$("body");var n=t.height();t.addClass("tvr-visual");TvrUi.default_to_first_sel();TvrUi.toolbarHeight=$("#v-top-controls").height();TvrUi.frameHeight=n-TvrUi.toolbarHeight;TvrUi.toggle_enabled_buttons();if(TvrUi.placeholderFrame){TvrUi.update_prog_indicator("plus","Loading WordPress Site...");$("#viframe").contents().find("body").css("height",TvrUi.frameHeight+"px");window.frames["viframe"].location=$("#viframe").attr("rel");TvrUi.placeholderFrame=false}$("#v-frontend-wrap").css("height",TvrUi.frameHeight);TvrUi.frameWidth=TvrUi.allDevicesWidth;if(!TvrUi.iframe_slider_set){TvrUi.update_iframe_slider(0,0)}},show_mq_slider:function(){$("#v-mq-controls").addClass("show")},hide_mq_slider:function(){$("#v-mq-controls").removeClass("show")},toolbar_adjusted:function(){TvrUi.toolbarHeight=$("#v-top-controls").height();TvrUi.frameHeight=$("body").height()-TvrUi.toolbarHeight;if(TvrUi.toolbarHeight>40){TvrUi.show_mq_slider()}else{TvrUi.hide_mq_slider()}$("#v-frontend-wrap").css("height",TvrUi.frameHeight)},toggle_enabled_buttons:function(){if(TvrUi.totalSels<1){TvrUi.reset_global_vars();$("#starter-message").removeClass("hidden");$("#quick-nav").addClass("hidden");$("#current-selector").text("")}if(TvrUi.totalSels>0){$("#starter-message").addClass("hidden");$("#quick-nav").removeClass("hidden")}},remember_page_viewed:function(){var e=$("#previewurl").val();var t=$("#ajaxUrl").attr("rel");var n=TvrUi.siteUrl;var r=$("#viframe").contents().find("#iframe-url").attr("content");var i=decodeURIComponent(r);if(TvrCom.hasValue(i)&&i.indexOf(n)===0&&i!=e&&!TvrUi.placeholderFrame){$.get(t+"&mcth_simple_ajax=1&tvr_microthemer_ui_preview_url="+r,function(){$("#previewStatus").text("iframe-success")});$("#previewurl").val(i)}},update_visual_controls:function(e){if(!TvrCom.isDomEl(e)){$("#vb-focus-prev, #vb-focus-next").addClass("disabled");return false}var t=TvrUi.get_meta(e,"selector");var n=TvrUi.selectorTrackerScan(t.sectionM,"prev","selector",t.selectorM);var r=TvrUi.selectorTrackerScan(t.sectionM,"next","selector",t.selectorM);if(n){$("#vb-focus-prev").removeClass("disabled")}else{$("#vb-focus-prev").addClass("disabled")}if(r){$("#vb-focus-next").removeClass("disabled")}else{$("#vb-focus-next").addClass("disabled")}TvrUi.get_meta(e,"selector")},selectorTrackerScan:function(e,t,n,r){if(t=="prev"){if(n=="selector"){var i=r.prev("li.strk-sel");if(TvrCom.hasValue(i.attr("id"))){return i}else{return TvrUi.selectorTrackerScan(e,t)}}var s=e.prev("li.strk-sec");if(TvrCom.hasValue(s.attr("id"))){var o=s.find(".strk-sel").last();if(TvrCom.hasValue(o.attr("id"))){return o}else{return TvrUi.selectorTrackerScan(s,t)}}else{return false}}else if(t=="next"){if(n=="selector"){var u=r.next("li.strk-sel");if(TvrCom.hasValue(u.attr("id"))){return u}else{return TvrUi.selectorTrackerScan(e,t)}}var a=e.next("li.strk-sec");if(TvrCom.hasValue(a.attr("id"))){var f=a.find(".strk-sel").first();if(TvrCom.hasValue(f.attr("id"))){return f}else{return TvrUi.selectorTrackerScan(a,t)}}else{return false}}},toggle_highlighting:function(){if(window.TvrSharedVars.highlightEnabled){TvrUi.hide_highlighting()}else{TvrUi.show_highlighting()}},show_highlighting:function(){window.TvrSharedVars.highlightEnabled=true;$("#toggle-highlighting").addClass("on");if(TvrUi.iframe_functions_loaded()){window.frames["viframe"].TvrExportVars.showOverlays()}},hide_highlighting:function(){window.TvrSharedVars.highlightEnabled=false;$("#toggle-highlighting").removeClass("on");if(TvrUi.iframe_functions_loaded()){window.frames["viframe"].TvrExportVars.hideOverlays()}},return_normal_highlighting:function(){if(window.TvrSharedVars.highlightEnabled&&window.TvrSharedVars.tmpHighlighting){window.TvrSharedVars.tmpHighlighting=false;TvrUi.toggle_highlighting()}if(TvrUi.iframe_functions_loaded()){window.frames["viframe"].TvrExportVars.switch_highlight("reg")}},tvr_iterate_selectors_v:function(e){var t=TvrUi.get_meta(e,"selector");if(!TvrUi.load_selector(t,"load selector before iterating")){$("#tvr-options").find("li.in-focus").removeClass("in-focus");t.selector.addClass("in-focus");TvrUi.update_global_vars(t);if(TvrUi.iframe_functions_loaded()){window.frames["viframe"].TvrExportVars.switch_highlight("reg")}TvrUi.update_visual_controls(e);TvrUi.refresh_comp_css();TvrUi.default_to_prev_edited_pg_group(t.selector);TvrUi.toolbar_adjusted()}},iframe_functions_loaded:function(){if(window.frames["viframe"]&&window.frames["viframe"].TvrExportVars&&window.frames["viframe"].TvrExportVars.switch_highlight&&window.frames["viframe"].TvrExportVars.get_computed_styles&&window.frames["viframe"].TvrExportVars.iframe_window_fully_loaded){window.TvrSharedVars.awaitingIFrame=false;return true}else{window.TvrSharedVars.awaitingIFrame=true;return false}},default_to_prev_edited_pg_group:function(e){var t=TvrUi.get_meta(e,"selector");var n=t.selector.find(".pg-focus").val();if(n){TvrUi.pg_icon_pressed(t.selector.find(".pg-icon-"+n))}},quick_nav:function(e){if(e.hasClass("disabled")){return false}var t=TvrUi.get_meta($("#"+TvrUi.selInFocusID),"selector");if(e.attr("id")=="vb-focus-prev"){var n="prev"}else{var n="next"}TvrUi.tvr_iterate_selectors_v(TvrUi.selectorTrackerScan(t.sectionM,n,"selector",t.selectorM))}};TvrUi.init();window.TvrSharedVars.print_r=TvrCom.print_r;window.TvrSharedVars.extract_str=TvrCom.extract_str;window.TvrSharedVars.custom_to_non_escaped=TvrCom.custom_to_non_escaped;window.TvrSharedVars.jquery_escape_quotes=TvrCom.jquery_escape_quotes;window.TvrSharedVars.hasValue=TvrCom.hasValue;window.TvrSharedVars.sane_decimal=TvrCom.sane_decimal;window.TvrSharedVars.isDomEl=TvrCom.isDomEl;window.TvrSharedVars.analyse_sel_code=TvrUi.analyse_sel_code;window.TvrSharedVars.update_prog_indicator=TvrUi.update_prog_indicator;window.TvrSharedVars.show_wizard=TvrUi.show_wizard;window.TvrSharedVars.update_selector_wizard=TvrUi.update_selector_wizard;window.TvrSharedVars.toggle_highlighting=TvrUi.toggle_highlighting;window.TvrSharedVars.insert_google_font=TvrUi.insert_google_font;window.TvrSharedVars.ajax_save_settings=TvrUi.ajax_save_settings;window.TvrSharedVars.remember_page_viewed=TvrUi.remember_page_viewed;window.TvrSharedVars.refresh_comp_css=TvrUi.refresh_comp_css;window.TvrSharedVars.close_all_expanded=TvrUi.close_all_expanded;window.TvrSharedVars.show_dialog=TvrUi.show_dialog;window.TvrSharedVars.update_packs_obj=TvrUi.update_packs_obj;window.TvrSharedVars.update_full_logs=TvrUi.update_full_logs})